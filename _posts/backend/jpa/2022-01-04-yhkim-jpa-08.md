---
layout: post
title: "[김영한 - JPA 기본] #8 프록시와 연관관계 관리"
subtitle: "..."
date: 2022-01-02 16:00 +0900
categories: backend
tags: jpa
comments: true
---

# 프록시

## 프록시의 정의 및 특징

- 실제 클래스를 상속받아서 만들어진 가짜 클래스이다
- 사용할 때는 진짜/가짜 유무를 구분하지 않고 사용하면 된다 한다 (이론상)
- 실제 객체의 참조를 보관한다
- `getReference()`를 통해서 프록시 객체를 초기화를 한다
- 처음 사용할 때 한 번만 초기화 한다
  - 초기화할 때 실제 엔티티로 바뀌는 것은 아니다
  - 초기화되면 프록시를 통해 실제 엔티티로 접근이 가능하다
- 프록시 객체는 원본 엔티티를 상속받기 때문에 타입체크시 `==`대신에 `instance of`를 사용하여 비교하자
- PC의 도움을 받을 수 없는 준영속(detached) 상태일 때, 프록시를 초기화하면 문제 발생

## 프록시 관련 API들

- 초기화 여부 확인
  - isLoaded
- 강제 초기화
  - Hibernate.initialize(entity)
  - jpa 표준은 강제 초기화가 없기 때문에
    - member.getName() 등을 호출하여 초기화 가능하다..
